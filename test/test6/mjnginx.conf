#魔戒负载均衡dynamic_resolve fallback=stale fail_timeout=60s; 
#azure承载节点-直接查找替换：
#azhk1  52.175.71.190
#azhk2  13.75.77.240
#azhk3  13.70.48.173
#dog开头为狗子节点177xx
#3go开头为胡三狗节点199xx
#fq开头为番茄
#cv开头为CV2
upstream jp{
        ip_hash;
	    #server 139.162.114.213:6622;  #jp1
	    server 13.114.20.245:6616;     #jp2-id71
	    server 23.100.98.106:6616;      #jp3-az
        server 3.112.127.92:6616;    #jp4
	    server 13.115.241.169:6616;    #jp5
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp; #健康检测
}
upstream cvjp{
        ip_hash;
	    server 3.112.127.92:8823 weight=6;
        server 23.100.98.106:8823 weight=6;
        server 172.105.207.66:8823 weight=2;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp; #健康检测
}
upstream sg{
        ip_hash;
	    #server 192.53.115.96:6619 weight=2;  #sg1 
	    server 54.179.30.184:6616;               #sg2
	    server 20.188.102.142:6619;          #sg3-az
	    server 13.212.108.118:6616;           #sg4
        server 18.142.56.43:6616;             #sg5
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvsg{
        ip_hash;
	    server 54.179.30.184:11112 weight=6;
	    server 20.188.102.142:11112 weight=6;
	    server 139.162.6.184:11112 weight=2;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream kr{
        ip_hash;	#vu+aws负载
        server 3.36.85.145:6616 weight=6;        #kr5
	server 13.124.198.115:6619 weight=6;     #kr3
        server 3.36.87.22:6616 weight=6;     #kr2
	server 3.35.229.156:6616 weight=6;       #kr4
        server 141.164.56.181:6621 weight=2;    #kr1
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvkr{
        ip_hash;	#vu+aws负载
        server 3.36.87.22:661 weight=6;
	server 3.36.85.145:661 weight=6;
        server 141.164.56.181:661 weight=2;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}

upstream hk{
        #ip_hash;	#HKT负载
        server 203.218.244.48:6622;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream hkntt{	
        server 103.166.247.34:6616;  #HK-NTT负载
		server 203.184.132.168:7777 backup;  #当NTT出现故障转移至HGC
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream hgc{
        server 203.184.132.168:7777;  #交给隧道处理
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvhgc{
        server 203.184.132.168:8819;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream fqhgc{
        server 203.184.132.168:777;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
#此处开始为AZ中转，三机器负载，换IP可进行查找替换
upstream hgc_vnet{
        server 52.175.71.190:26721;  #交给隧道处理
        server 13.75.77.240:26721;
        server 13.70.48.173:26721;
        server 103.166.247.34:26721 backup;
        server 103.166.247.35:26721 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream malai_vnet{
        server 52.175.71.190:26623;  #交给隧道处理
		server 13.75.77.240:26623;
		server 13.70.48.173:26623;
        server 103.166.247.34:26623 backup;
        server 103.166.247.35:26623 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvmalai_vnet{
        server 52.175.71.190:26610;  #交给隧道处理
		server 13.75.77.240:26610;
		server 13.70.48.173:26610;
        server 103.166.247.34:26610 backup;
        server 103.166.247.35:26610 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream fqmalai_vnet{
        server 52.175.71.190:10044;  #交给隧道处理
		server 13.75.77.240:10044;
		server 13.70.48.173:10044;
        server 103.166.247.34:10044 backup;
        server 103.166.247.35:10044 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvhkt{
        server 203.218.244.48:555;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream tw_n{
        server 52.175.71.190:16616;  #二次反代
        server 13.75.77.240:16616;
        server 13.70.48.173:16616;
        server 103.166.247.34:16616 backup;
        server 103.166.247.35:16616 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvtw{
        server 52.175.71.190:23324;  #二次反代
        server 13.75.77.240:23324;
        server 13.70.48.173:23324;
        server 103.166.247.34:23324 backup;
        server 103.166.247.35:23324 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream fqtw{
        server 52.175.71.190:23330;  #二次反代
        server 13.75.77.240:23330;
        server 13.70.48.173:23330;
        server 103.166.247.34:23330 backup;
        server 103.166.247.35:23330 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream coconut{
        server 52.175.71.190:33346;  #交给隧道处理
        server 13.75.77.240:33346;
        server 13.70.48.173:33346;
        server 103.166.247.34:33346 backup;
        server 103.166.247.35:33346 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream ru{
        server 194.5.78.89:6617;  #魔戒俄罗斯
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream in{
        server 192.46.213.179:6616;  #魔戒印度
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream mjar{
        server 66.97.45.200:6616;  #魔戒阿根廷
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream lagos{
        server 165.154.234.36:6616;  #魔戒非洲
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream xy_hgc_vnet{
        server 52.175.71.190:22383;  #交给隧道处理-xinyun_vnet负载
		server 13.75.77.240:22383;
		server 13.70.48.173:22383;
        server 103.166.247.34:22383 backup;
        server 103.166.247.35:22383 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
#魔戒端口监听
server {
    listen 16616;
    location / {
		proxy_pass http://tw_n;   #台湾采用nginx二次反代
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16617;
    location / {
		proxy_pass http://jp;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16618;
    location / {
		proxy_pass http://sg;
		include /usr/local/nginx/ws; 
        }
	location /status { #监控页面
        check_status;
        access_log   off;
    }
}
server {
    listen 16619;
    location / {
		proxy_pass http://kr;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16620;
    location / {
		proxy_pass http://hk;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16621;
    location / {
		proxy_pass http://hgc;
		include /usr/local/nginx/ws; 
        }
}  #16622是hkbn，暂时无了
server {
    listen 16623;
    location / {
		proxy_pass http://malai_vnet;  #马来西亚
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16624;
    location / {
		proxy_pass http://hkntt;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16625;
    location / {
		proxy_pass http://ru;  #魔戒俄罗斯
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16626;
    location / {
		proxy_pass http://in;  #魔戒印度
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16627;
    location / {
		proxy_pass http://lagos;  #魔戒非洲
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16628;
    location / {
		proxy_pass http://mjar;  #魔戒阿根廷
		include /usr/local/nginx/ws; 
        }
}
#cv和fq
server {
    listen 29901;
    location / {
		proxy_pass http://cvsg;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 28802;
    location / {
		proxy_pass http://cvjp;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26602;
    location / {
		proxy_pass http://cvkr;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23318;
    location / {
		proxy_pass http://cvhgc;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23321;
    location / {
		proxy_pass http://fqhgc;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23324;
    location / {
		proxy_pass http://cvtw; #二次反代
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23330;
    location / {
		proxy_pass http://fqtw;    #二次反代
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23338;
    location / {
		proxy_pass http://cvhkt;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16610;
    location / {
		proxy_pass http://cvmalai_vnet; 
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 10144;
    location / {
		proxy_pass http://fqmalai_vnet; 
		include /usr/local/nginx/ws; 
        }
}
#狗子负载均衡（177xx段）
#xinyun_vnet负载
server {
    listen 22383;
    location / {
		proxy_pass http://xy_hgc_vnet;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 33445;
    location / {
		proxy_pass http://coconut;  #coconut
		include /usr/local/nginx/ws; 
        }
}
