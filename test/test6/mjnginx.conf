#魔戒负载均衡dynamic_resolve fallback=stale fail_timeout=60s; 
#azure承载节点-直接查找替换：
#azhk1-f4s1  20.187.123.150  优先级10,az1
#azhk1-f4s2  23.98.42.217   优先级10,az1
#azhk2-1    20.205.115.137  优先级3，az2全部
#azhk2-2    20.187.68.36
#azhk2-3	52.184.96.133
#azhk2-4	52.184.97.245
#azhk-backup 153.122.102.51 gmo日本1
#azhk-backup 153.122.173.25 gmo日本2
#azbackup 日本NTT 164.70.90.243   香港103.166.247.35
#dog开头为狗子节点177xx
#3go开头为胡三狗节点199xx
#fq开头为番茄
#cv开头为CV2
upstream jp{
        ip_hash;
	    #server 139.162.114.213:6622;  #jp1
	    #server 164.70.90.31:6617;     #jp2-ntt1
	    server 5.180.76.31:6617;      #jp3-digital-N1
        #server 140.227.127.103:6617;    #jp4-ntt2 
	    server 45.11.1.11:6616;    #jp3-digital-N2
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp; #健康检测
}
upstream cvjp{
        ip_hash;
	    #server 13.231.74.223:8818 weight=6;
	    #server 109.166.36.51:8818 weight=6;
        server 140.227.127.103:8818 weight=6;
        #server 172.105.207.66:8818 weight=2;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp; #健康检测
}
upstream sg{  
        server 20.187.123.150:16618 weight=10;  #SG尝试交给隧道处理
        server 23.98.42.217:16618 weight=10;
        server 20.205.115.137:16618 weight=3;
        server 20.187.68.36:16618 weight=3;
        server 52.184.96.133:16618 weight=3;
        server 52.184.97.245:16618 weight=3;
        server 153.122.102.51:16618 backup;
        server 153.122.173.25:16618 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvsg{
        ip_hash;
	    server 172.104.171.11:11112 weight=6;
	    #server 54.255.42.118:11112 weight=6;
	    #server 52.221.197.192:11112 weight=6;
	    server 139.162.39.77:11112 weight=2;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream kr{
        ip_hash;	#vu+aws负载
        #server 3.36.46.155:6616 weight=6;        #kr5
        server 141.164.41.110:6617 weight=6;     #kr2
        server 141.164.39.232:6616 weight=2;     #kr3
        #server 3.35.164.82:6616 weight=100;       #kr4
        server 141.164.56.181:6623 weight=2;    #kr1
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvkr{
        ip_hash;	#vu+aws负载
        #server 3.35.164.82:661 weight=6;
        #server 3.36.46.155:661 weight=6;
        #server 3.35.165.19:661 weight=6;
        server 141.164.56.181:1663 weight=2;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream hk{
        #ip_hash;	#HKT负载
        server 203.218.244.193:6622;
        server 203.218.244.75:6622;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream uk{
        ip_hash;	#vu英国负载
        server 45.77.230.140:6616 weight=6;
        server 95.179.201.0:6616 weight=6;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream fr{
        ip_hash;	#vu法国负载
        server 95.179.215.128:6616 weight=6;
        server 45.32.150.180:6616 weight=6;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream hkntt{	
        server 164.70.90.243:6616;  #HK-NTT负载
		server 203.184.132.168:7777 backup;  #当NTT出现故障转移至HGC
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream hgc{
        server 203.184.132.168:7777;  #交给隧道处理
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvhgc{
        server 203.184.132.168:8819;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream fqhgc{
        server 203.184.132.168:777;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream tw_n{
        server 20.187.123.150:16616 weight=10;
        server 23.98.42.217:16616 weight=10;
        server 20.205.115.137:16616 weight=3;
        server 20.187.68.36:16616 weight=3;
        server 52.184.96.133:16616 weight=3;
        server 52.184.97.245:16616 weight=3;
        server 153.122.102.51:16616 backup;
        server 153.122.173.25:16616 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
#此处开始为AZ中转，三机器负载，换IP可进行查找替换
upstream hgc_vnet{   #交给隧道处理
        server 20.187.123.150:26721 weight=10;
        server 23.98.42.217:26721 weight=10;
        server 20.205.115.137:26721 weight=3;
        server 20.187.68.36:26721 weight=3;
        server 52.184.96.133:26721 weight=3;
        server 52.184.97.245:26721 weight=3;
        server 153.122.102.51:26721 backup;
        server 153.122.173.25:26721 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream hk_az{   #交给隧道处理-az-fdc
        server 20.187.123.150:26633 weight=10;
        server 23.98.42.217:26633 weight=10;
        server 20.205.115.137:26633 weight=3;
        server 20.187.68.36:26633 weight=3;
        server 52.184.96.133:26633 weight=3;
        server 52.184.97.245:26633 weight=3;
        server 153.122.102.51:26633 backup;
        server 153.122.173.25:26633 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream malai_vnet{ 
		server 20.187.123.150:26623 weight=10;#交给隧道处理
        server 23.98.42.217:26623 weight=10;
        server 20.205.115.137:26623 weight=3;
        server 20.187.68.36:26623 weight=3;
        server 52.184.96.133:26623 weight=3;
        server 52.184.97.245:26623 weight=3;
        server 153.122.102.51:26623 backup;
        server 153.122.173.25:26623 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvmalai_vnet{
		server 20.187.123.150:26610 weight=10;  #交给隧道处理
        server 23.98.42.217:26610 weight=10;
        server 20.205.115.137:26610 weight=3;
        server 20.187.68.36:26610 weight=3;
        server 52.184.96.133:26610 weight=3;
        server 52.184.97.245:26610 weight=3;
        server 153.122.102.51:26610 backup;
		server 153.122.173.25:26610 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream fqmalai_vnet{
		server 20.187.123.150:10044 weight=10;  #交给隧道处理
        server 23.98.42.217:10044 weight=10;
        server 20.205.115.137:10044 weight=3;
        server 20.187.68.36:16618 weight=3;
        server 52.184.96.133:10044 weight=3;
        server 52.184.97.245:10044 weight=3;
        server 153.122.102.51:10044 backup;
        server 153.122.173.25:10044 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvhkt{
        server 203.218.244.193:555;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvtw{
        server 20.187.123.150:23324 weight=10;  #二次反代
        server 23.98.42.217:23324 weight=10;
        server 20.205.115.137:23324 weight=3;
        server 20.187.68.36:23324 weight=3;
        server 52.184.96.133:23324 weight=3;
        server 52.184.97.245:23324 weight=3;
        server 153.122.102.51:23324 backup;
        server 153.122.173.25:23324 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream fqtw{
        server 20.187.123.150:23330 weight=10;  #二次反代
        server 23.98.42.217:23330 weight=10;
        server 20.205.115.137:23330 weight=3;
        server 20.187.68.36:23330 weight=3;
        server 52.184.96.133:23330 weight=3;
        server 52.184.97.245:23330 weight=3;
        server 153.122.102.51:23330 backup;
        server 153.122.173.25:23330 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream coconut{
        server 20.187.123.150:33346 weight=10;   #交给隧道处理
        server 23.98.42.217:33346 weight=10;
        server 20.205.115.137:33346 weight=3;
        server 20.187.68.36:33346 weight=3;
        server 52.184.96.133:33346 weight=3;
        server 52.184.97.245:33346 weight=3;
        server 153.122.102.51:33346 backup;
        server 103.166.247.35:33346 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
#结束
upstream ru{
        server 193.38.51.57:6619;  #魔戒俄罗斯
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream in{
        server 192.46.213.179:6616;  #魔戒印度
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream mjar{
        server 66.97.36.136:6616;  #魔戒阿根廷
		#server 168.197.48.104:6616;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream lagos{
        server 165.154.234.36:6616;  #魔戒非洲
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream xy_hgc_vnet{
		server 20.187.123.150:22383 weight=10;  #交给隧道处理-xinyun_vnet负载
        server 20.205.115.137:22383 weight=3;
        server 20.187.68.36:22383 weight=3;
        server 52.184.96.133:22383 weight=3;
        server 52.184.97.245:22383 weight=3;
        server 153.122.102.51:22383 backup;
        server 153.122.173.25:22383 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
#魔戒端口监听
server {
    listen 16616;
    location / {
		proxy_pass http://tw_n;   #台湾采用nginx二次反代
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16617;
    location / {
		proxy_pass http://jp;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16618;
    location / {
		proxy_pass http://sg;
		include /usr/local/nginx/ws; 
        }
	location /status { #监控页面
        check_status;
        access_log   off;
    }
}
server {
    listen 16619;
    location / {
		proxy_pass http://kr;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16620;
    location / {
		proxy_pass http://hk;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16621;
    location / {
		proxy_pass http://hgc;
		include /usr/local/nginx/ws; 
        }
}  #16622是hkbn
server {
    listen 16622;
    location / {
		proxy_pass http://210.0.159.89:6616; #新HGC
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16624;
    location / {
		proxy_pass http://hkntt;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16625;
    location / {
		proxy_pass http://ru;  #魔戒俄罗斯
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16626;
    location / {
		proxy_pass http://in;  #魔戒印度
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16627;
    location / {
		proxy_pass http://lagos;  #魔戒非洲
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16628;
    location / {
		proxy_pass http://mjar;  #魔戒阿根廷
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16629;
    location / {
		proxy_pass http://147.78.2.229:6616;  #魔戒以色列
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16630;
    location / {
		proxy_pass http://185.219.133.108:6616;  #魔戒土耳其
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16631;
    location / {
		proxy_pass http://42.200.190.71:6616;  #HKT2
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16632;
    location / {
		proxy_pass http://66.94.125.131:6616;  #US
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16633;
    location / {
		proxy_pass http://50.7.59.195:6616;  #FDC-HK
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16634;
    location / {
		proxy_pass http://218.252.25.221:6616;  #icable
		include /usr/local/nginx/ws; 
        }
}
#MJ嵌套区域-az
server {
    listen 26633;
    location / {
		proxy_pass http://hk_az;  #az到FDC
		include /usr/local/nginx/ws; 
        }
}
#cv和fq
server {
    listen 29901;
    location / {
		proxy_pass http://cvsg;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 28802;
    location / {
		proxy_pass http://cvjp;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26602;
    location / {
		proxy_pass http://cvkr;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23318;
    location / {
		proxy_pass http://cvhgc;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23321;
    location / {
		proxy_pass http://fqhgc;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23315;
    location / {
		proxy_pass http://uk;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23383;
    location / {
		proxy_pass http://fr;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23324;
    location / {
		proxy_pass http://cvtw; #二次反代
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23330;
    location / {
		proxy_pass http://fqtw;    #二次反代
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23338;
    location / {
		proxy_pass http://cvhkt;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26610;
    location / {
		proxy_pass http://cvmalai_vnet; 
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26623;
    location / {
		proxy_pass http://malai_vnet; 
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 10044;
    location / {
		proxy_pass http://fqmalai_vnet; 
		include /usr/local/nginx/ws; 
        }
}
#狗子负载均衡（177xx段）
#xinyun_vnet负载
server {
    listen 22383;
    location / {
		proxy_pass http://xy_hgc_vnet;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 33445;
    location / {
		proxy_pass http://coconut;  #coconut
		include /usr/local/nginx/ws; 
        }
}
#CV2节点
server {
    listen 23308; #美国
    location / {
		proxy_pass http://66.94.125.131:1005;   
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26612; #香港
    location / {
		proxy_pass http://203.218.244.75:8821;   
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26609; #香港 HKBN
    location / {
		proxy_pass http://210.0.159.89:335;   
		include /usr/local/nginx/ws; 
        }
}
