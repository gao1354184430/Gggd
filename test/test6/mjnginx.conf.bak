#start
#魔戒负载均衡dynamic_resolve fallback=stale fail_timeout=60s;  
#azure承载节点-直接查找替换
#azjp0-f4s   20.78.76.190
#azjp1-f4s   20.194.219.125
#azjp2-f4s   20.243.249.216
#azjp3-f4s   20.222.112.24
#azjp4-f4s   20.89.131.156
#azjp5-f4s   20.210.206.123  
#azsg6-f4s   20.212.119.226
#azsg7-f4s   20.212.6.61
#azsg8-f2s   20.212.63.117
#azhk13-f4s  20.205.42.4
#azhk14-f4s  20.239.94.152
#azhk16-f4s  104.208.118.158
#azhk-backup 153.122.102.51 gmo日本1
#azhk-backup 153.122.173.25 gmo日本2
#azbackup 日本NTT 164.70.90.243   香港103.166.247.35
upstream jp{
        #ip_hash;  #MJ-JP AZ承载  微调后由azjp3.4.5.6联入，其他备份
        server 20.78.76.190:16617;
		server 20.194.219.125:16617;
		server 20.243.249.216:16617;
		server 20.222.112.24:16617;
        server 20.89.131.156:16617;
        server 20.210.206.123:16617;
        server 20.212.119.226:16617 backup;
        server 20.212.6.61:16617 backup;
        server 20.212.63.117:16617 backup; #azhk9临时
        server 20.205.42.4:16617 backup; 
		server 20.239.94.152:16617 backup; 
		server 104.208.118.158:16617 backup; 
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp; #健康检测
}
upstream cvjp{
        #ip_hash;
        server 20.78.76.190:26601;
		server 20.194.219.125:26601;
		server 20.243.249.216:26601;
		server 20.222.112.24:26601;
        server 20.89.131.156:26601;
        server 20.210.206.123:26601;
        server 20.212.119.226:26601 backup;
        server 20.212.6.61:26601 backup;
        server 20.212.63.117:26601 backup;
        server 20.205.42.4:26601 backup;
		server 20.239.94.152:26601 backup;
		server 104.208.118.158:26601 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp; #健康检测
}
upstream sg{
        #ip_hash;  #BGP承载，AZ备用
        server 20.78.76.190:16618 backup;
		server 20.194.219.125:16618 backup;
		server 20.243.249.216:16618 backup;
		server 20.222.112.24:16618 backup;
        server 20.89.131.156:16618 backup;
        server 20.210.206.123:16618 backup;
        server 20.212.119.226:16618;
        server 20.212.6.61:16618;
        server 20.212.63.117:16618; #
        server 20.205.42.4:16618 backup; #az13
		server 20.239.94.152:16618 backup; #az14
		server 104.208.118.158:16618 backup; #az16
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp; #健康检测
}
upstream cvsg{
        #ip_hash;  #BGP承载，AZ备用
        server 20.212.119.226:26603 backup;
        server 20.212.6.61:26603 backup;
        server 20.78.76.190:26603 backup;
		server 20.194.219.125:26603 backup;
		server 20.243.249.216:26603 backup;
		server 20.222.112.24:26603 backup;
        server 20.89.131.156:26603;
        server 20.210.206.123:26603;
        server 20.212.63.117:26603;
        server 20.205.42.4:26603 backup;
		server 20.239.94.152:26603 backup;
		server 104.208.118.158:26603 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp; #健康检测
}
upstream cvhk{
        #ip_hash;  #BGP承载，AZ备用
        server 20.212.119.226:26607;
        server 20.212.6.61:26607;
        server 20.78.76.190:26607;
		server 20.194.219.125:26607;
		server 20.243.249.216:26607;
		server 20.222.112.24:26607;
        server 20.89.131.156:26607;
        server 20.210.206.123:26607;
        server 20.212.63.117:26607; #azhk9
        server 20.205.42.4:26607; #az13
		server 20.239.94.152:26607; #az14
		server 104.208.118.158:26607; #az16
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp; #健康检测
}
upstream tw_n{
        server 20.78.76.190:16616;
		server 20.194.219.125:16616;
		server 20.243.249.216:16616;
		server 20.222.112.24:16616;
        server 20.89.131.156:16616;
        server 20.210.206.123:16616;
        server 20.212.119.226:16616;
        server 20.212.6.61:16616;
        server 20.212.63.117:16616; #azhk9
        server 20.205.42.4:16616; #azjp13
		server 20.239.94.152:16616; #azjp14
		server 104.208.118.158:16616; #azjp16
        server 153.122.102.51:16616 backup;
        server 153.122.173.25:16616 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvtw{
        server 20.212.119.226:26604;
        server 20.212.6.61:26604;
        server 20.78.76.190:26604;  #二次反代-包含BGP
		server 20.194.219.125:26604;  #二次反代-包含BGP
		server 20.243.249.216:26604;  #二次反代-包含BGP
		server 20.222.112.24:26604;  #二次反代-包含BGP
        server 20.89.131.156:26604;
        server 20.210.206.123:26604;
        server 20.212.63.117:26604; #azhk9
        server 20.205.42.4:26604; #azjp13
		server 20.239.94.152:26604; #azjp14
		server 104.208.118.158:26604; #azjp16
        server 153.122.102.51:26604 backup;
        server 153.122.173.25:26604 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream fqtw{
        server 20.78.76.190:23330;  #二次反代
		server 20.194.219.125:23330;  #二次反代
		server 20.243.249.216:23330;  #二次反代
		server 20.222.112.24:23330;  #二次反代
        server 20.89.131.156:23330;
        server 20.210.206.123:23330;
        server 20.212.119.226:23330;
        server 20.212.6.61:23330;
        server 20.212.63.117:23330; #azhk9
        server 20.205.42.4:23330; #azjp13
		server 20.239.94.152:23330; #azjp14
		server 104.208.118.158:23330; #azjp16
        server 153.122.102.51:23330 backup;
        server 153.122.173.25:23330 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream mjhk{
        server 20.212.119.226:16620 backup;   #HKT
        server 20.212.6.61:16620 backup;
        server 20.78.76.190:16620 backup;
		server 20.194.219.125:16620 backup;
		server 20.243.249.216:16620 backup;
		server 20.222.112.24:16620 backup;
        server 20.89.131.156:16620 backup;
        server 20.210.206.123:16620 backup;
        server 20.212.63.117:16620 backup; #azhk9
        server 20.205.42.4:16620; #az13
		server 20.239.94.152:16620; #az14
		server 104.208.118.158:16620; #az16
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream mjazhk{  #MJ-az-默认直接azhk4落地，故障转移az承载-FDC落地
        server 20.239.92.230:6622;     #AZHK9F8s   ID268
		server 20.24.211.64:6622;     #AZHK17F8s   ID269
		server 104.208.108.79:6622 weight=3;     #AZHK18F8s   ID270
		server 20.24.211.134:6622;  #AZHK19   ID271
		server 20.239.90.123:6622;  #AZHK10   ID167
		server 20.24.68.173:6622;  #AZHK15F8S   ID238
        server 20.24.64.119:6622 weight=3;  #由椰子添加AWS1-测试，ID267
        server 20.212.119.226:16620 backup; #weight=5
        server 20.212.6.61:16620 backup;
        server 20.78.76.190:16620 backup;
		server 20.194.219.125:16620 backup;
		server 20.243.249.216:16620 backup;
		server 20.222.112.24:16620 backup;
        server 20.89.131.156:16620 backup;
        server 20.210.206.123:16620 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream mjeufi{  #欧洲承载（DE）目的地芬兰
        server 89.163.224.151:16643;  #直连IP 37.157.255.188
        server 54.38.220.90:16643 backup;  #直连 54.37.203.19
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream mjde{
        #ip_hash;	#de德国
        server 89.163.224.151:6616;  #直连IP 37.157.255.188
        server 54.38.220.90:6616 backup; #直连 54.37.203.19
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream mjusla{
        ip_hash;	#美国
        server 194.156.224.83:6616;  #dedipath
        server 45.8.22.118:6616; #advinservers
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream fr{
        #ip_hash;	#vu法国负载
        server 212.129.58.216:6616;
        #server 95.179.213.2:6616 weight=6;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream br{
        ip_hash;	#vu巴西负载
        server 216.238.103.47:6616;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream mjmx{
        ip_hash;	#vu墨西哥负载
        server 216.238.81.179:6616;	
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream ru{
        server 45.144.179.69:6616;  #魔戒俄罗斯
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream mjkh{
        #ip_hash;    #魔戒柬埔寨
        server 220.158.232.156:6616;
        #server 220.158.232.157:6616;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream mjeupt{	 #欧洲承载（DE）目的地葡萄牙
        server 5.182.39.30:6616;
        #server 89.163.224.151:16624;
        #server 54.38.220.90:16624;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvhgc{
        #ip_hash;  # AZ承载
        server 20.78.76.190:26608;
		server 20.194.219.125:26608;
		server 20.243.249.216:26608;
		server 20.222.112.24:26608;
        server 20.89.131.156:26608;
        server 20.210.206.123:26608;
        server 20.212.119.226:26608;
        server 20.212.6.61:26608;
        server 20.212.63.117:26608; 
        server 20.205.42.4:26608; 
		server 20.239.94.152:26608;
		server 104.208.118.158:26608;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp; #健康检测
}
upstream fqhgc{
        server 210.0.158.101:7711;
		#check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
#此处开始为AZ中转，三机器负载，换IP可进行查找替换
upstream malai_vnet{ 
		server 20.78.76.190:26623;#交给隧道处理
		server 20.194.219.125:26623;#交给隧道处理
		server 20.243.249.216:26623;#交给隧道处理
		server 20.222.112.24:26623;#交给隧道处理
        server 20.89.131.156:26623;
        server 20.210.206.123:26623;
        server 20.212.119.226:26623;
        server 20.212.6.61:26623;
        server 20.212.63.117:26623; #azhk9
        server 20.205.42.4:26623; #az13
		server 20.239.94.152:26623; #az14
		server 104.208.118.158:26623; #az16
        server 153.122.102.51:26623 backup;
        server 153.122.173.25:26623 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream cvmalai_vnet{
		server 20.78.76.190:26610;  #交给隧道处理
		server 20.194.219.125:26610;  #交给隧道处理
		server 20.243.249.216:26610;  #交给隧道处理
		server 20.222.112.24:26610;  #交给隧道处理
        server 20.89.131.156:26610;
        server 20.210.206.123:26610;
        server 20.212.119.226:26610;
        server 20.212.6.61:26610;
        server 153.122.102.51:26610 backup;
		server 153.122.173.25:26610 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
upstream fqmalai_vnet{
		server 20.78.76.190:10044;  #交给隧道处理
		server 20.194.219.125:10044;  #交给隧道处理
		server 20.243.249.216:10044;  #交给隧道处理
		server 20.222.112.24:10044;  #交给隧道处理
        server 20.89.131.156:10044;
        server 20.210.206.123:10044;
        server 20.212.119.226:10044;
        server 20.212.6.61:10044;
        server 153.122.102.51:10044 backup;
        server 153.122.173.25:10044 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
#结束
upstream mjar{
        server 20.78.76.190:16628;
		server 20.194.219.125:16628;
		server 20.243.249.216:16628;
		server 20.222.112.24:16628;
        server 20.89.131.156:16628;
        server 20.210.206.123:16628;
        server 20.212.119.226:16628;
        server 20.212.6.61:16628;
        server 20.212.63.117:16628; #azhk9
        server 20.205.42.4:16628; #az13
		server 20.239.94.152:16628; #az14
		server 104.208.118.158:16628; #az16
        server 153.122.102.51:16628 backup;
        server 153.122.173.25:16628 backup;
		check interval=5000 rise=2 fall=2 timeout=3000 type=tcp;
}
#魔戒端口监听
server {
    listen 16616;
    location / {
		proxy_pass http://tw_n;   #台湾采用nginx二次反代
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16617;
    location / {
		proxy_pass http://jp;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16618;
    location / {
		proxy_pass http://sg;
		include /usr/local/nginx/ws; 
        }
	location /status { #监控页面
        check_status;
        access_log   off;
    }
}
server {
    listen 16620;
    location / {
		proxy_pass http://mjhk;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16624;
    location / {
		proxy_pass http://mjeupt;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16625;
    location / {
		proxy_pass http://ru;  #魔戒俄罗斯
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16626;
    location / {
		proxy_pass http://45.79.125.94:6618;  #魔戒印度mjin
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16627;
    location / {
		proxy_pass http://mjazhk;  #魔戒AZHK落地
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16629;
    location / {
		proxy_pass http://77.91.74.10:6616;  #魔戒以色列
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16633;
    location / {
		proxy_pass http://5.182.36.178:6616;  #PQ瑞士
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16635;
    location / {
		proxy_pass http://br;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16636;
    location / {
		proxy_pass http://mjmx;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16637;   #乌克兰-基辅
    location / {
		proxy_pass http://45.87.155.63:6616;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16638;   #澳洲-悉尼
    location / {
		proxy_pass http://170.187.240.57:6616;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16639;   #非洲-尼日利亚-拉各斯
    location / {
		proxy_pass http://185.255.123.100:6616;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16640;   #非洲-南非
    location / {
		proxy_pass http://197.189.207.7:6616;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16641;   #加拿大东海岸
    location / {
		proxy_pass http://149.56.133.8:6616;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16642;   #荷兰
    location / {
		proxy_pass http://62.4.14.33:6616;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16643;   #芬兰-经德国中转
    location / {
		proxy_pass http://mjeufi;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16645;
    location / {
		proxy_pass http://fr;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16646;
    location / {
		proxy_pass http://77.91.102.96:6616;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16648;
    location / {
		proxy_pass http://mjusla;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 16654;  #夏威夷
    location / {
		proxy_pass http://208.72.154.177:6616;
		include /usr/local/nginx/ws; 
        }
}
#cv和fq-CV2节点
server {
    listen 26601;
    location / {
		proxy_pass http://cvjp;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26602;
    location / {
		proxy_pass http://158.247.227.22:8818;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26603;
    location / {
		proxy_pass http://cvsg;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26604;
    location / {
		proxy_pass http://cvtw; #二次反代
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26605;
    location / {
		proxy_pass http://220.246.250.241:8818; #CV2 HKT
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26606;
    location / {
		proxy_pass http://173.255.250.95:8818; #Linode美国
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26607;
    location / {
		proxy_pass http://cvhk;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26608;
    location / {
		proxy_pass http://cvhgc;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26609; #香港 HKBN
    location / {
		proxy_pass http://46.20.99.58:8818;   
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26610;
    location / {
		proxy_pass http://cvmalai_vnet; 
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26612; #香港
    location / {
		proxy_pass http://203.218.244.202:8879;   
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26616; #香港 HGC
    location / {
		proxy_pass http://223.18.59.110:8819;   
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26617; #俄罗斯
    location / {
		proxy_pass http://45.144.179.69:8818;   
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26618; #德国
    location / {
		proxy_pass http://54.38.220.90:8818;   
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 26623;
    location / {
		proxy_pass http://malai_vnet; 
		include /usr/local/nginx/ws; 
        }
}
#266**结束
server {
    listen 23308; #美国
    location / {
		proxy_pass http://66.94.125.131:1666;   
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23321;
    location / {
		proxy_pass http://fqhgc;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23309;
    location / {
		proxy_pass http://mjde;
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 23330;
    location / {
		proxy_pass http://fqtw;    #二次反代
		include /usr/local/nginx/ws; 
        }
}
server {
    listen 10044;
    location / {
		proxy_pass http://fqmalai_vnet; 
		include /usr/local/nginx/ws; 
        }
}
#end
