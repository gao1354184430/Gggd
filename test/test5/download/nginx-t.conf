user  root;
worker_processes auto;
worker_rlimit_nofile 51200;
pid        /usr/local/nginx/logs/nginx.pid;
events
    {
        use epoll;
        worker_connections 51200;
        multi_accept on;
    }
stream {
    upstream hkt{
        server 220.246.250.224:6626;
    }
    server {
        listen  443 ssl;  
        server_name hkt.iamnotagoodman.com;
        ssl_protocols    TLSv1.2 TLSv1.3;      # 设置使用的SSL协议版本
        ssl_certificate /root/t20230919.pem; # 证书地址
        ssl_certificate_key /root/t20230919.key; # 秘钥地址
        ssl_session_cache   shared:SSL:10m;             # SSL TCP会话缓存设置共享内存区域名为
                                                        # SSL，区域大小为10MB
        ssl_session_timeout 10m;                        # SSL TCP会话缓存超时时间为10分钟
        proxy_protocol    on; # 开启proxy_protocol获取真实ip
        proxy_pass hkt;
    }
    server {
        listen  443 ssl;                    # 设置监听端口为443
        server_name sg.iamnotagoodman.com;
        ssl_protocols    TLSv1.2 TLSv1.3;      # 设置使用的SSL协议版本

        ssl_certificate /root/t20230919.pem; # 证书地址
        ssl_certificate_key /root/t20230919.key; # 秘钥地址
        ssl_session_cache   shared:SSL:10m;             # SSL TCP会话缓存设置共享内存区域名为
                                                        # SSL，区域大小为10MB
        ssl_session_timeout 10m;                        # SSL TCP会话缓存超时时间为10分钟
        proxy_protocol    on; # 开启proxy_protocol获取真实ip
        proxy_pass        127.0.0.1:6616; # 后端Trojan监听端口
    }
}

http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  120;
    keepalive_requests 10000;
    check_shm_size 50m;
    access_log  off;
    #vmess-ws
    include /usr/local/nginx/*.conf;
}
